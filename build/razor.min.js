/*
 Razor Javascript Framework (Beta).
 author: Razorfish London.
*/
var Razor=Razor||{version:"beta",FPS:!0,logging:!0};Razor.addBindSupport=function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e})};
Razor.inherits=function(a,b){var c=function(){};c.prototype=b.prototype;a.superClass=b.prototype;a.prototype=new c;a.prototype.constructor=a};Razor.getBoundingBox=function(a){for(var b="",c=0,d=0;"object"==typeof a&&"undefined"!=typeof a.tagName;)d+=a.offsetTop,c+=a.offsetLeft,b=a.tagName.toUpperCase(),"BODY"==b&&(a=0),"object"==typeof a&&"object"==typeof a.offsetParent&&(a=a.offsetParent);return{x:c,y:d}};Razor.Vector2=function(a,b){var c=new Float32Array(2);Razor.Vector2.set(c,a||0,b||0);return c};Razor.Vector2.setX=function(a,b){a[0]=b;return this};Razor.Vector2.setY=function(a){a[1]=y;return this};Razor.Vector2.set=function(a,b,c){Razor.Vector2.setX(a,b);Razor.Vector2.setY(a,c);return this};Razor.SimpleNoise=function(){this.height=this.width=50;this.whiteNoiseCanvas=document.createElement("canvas");this.simpleNoiseCanvas=document.createElement("canvas");this.contextNoise=this.whiteNoiseCanvas.getContext("2d");this.contextSimple=this.simpleNoiseCanvas.getContext("2d");this.B=this.G=this.R=0;this.A=1;this.isGrayscale=!1;this.init()};Razor.SimpleNoise.prototype.init=function(){this.setDetail(this.width,this.height);this.generate()};
Razor.SimpleNoise.prototype.setDetail=function(a,b){this.width=a;this.height=b;this.whiteNoiseCanvas.width=this.simpleNoiseCanvas.width=this.width;this.whiteNoiseCanvas.height=this.simpleNoiseCanvas.height=this.height};Razor.SimpleNoise.prototype.setRed=function(a){this.isGrayscale=!1;this.R=a};Razor.SimpleNoise.prototype.setGreen=function(a){this.isGrayscale=!1;this.G=a};Razor.SimpleNoise.prototype.setBlue=function(a){this.isGrayscale=!1;this.B=a};
Razor.SimpleNoise.prototype.setGrayscale=function(a){this.isGrayscale=!0;this.R=this.B=this.G=a};Razor.SimpleNoise.prototype.generate=function(){this.buildWhiteNoise();this.buildSimpleNoise()};Razor.SimpleNoise.prototype.getRandom=function(){var a=Math.random();this.isGrayscale&&(a=0);return a};
Razor.SimpleNoise.prototype.buildWhiteNoise=function(){var a=this.contextSimple.createImageData(this.width,this.height),b=a.data;if(this.isGrayscale)for(var c=0;c<b.length;c+=4){var d=Math.random();b[c]=d*this.R;b[c+1]=d*this.G;b[c+2]=d*this.B;b[c+3]=255}else for(c=0;c<b.length;c+=4)Math.random(),b[c]=Math.random()*this.R,b[c+1]=Math.random()*this.G,b[c+2]=Math.random()*this.B,b[c+3]=255;this.contextNoise.putImageData(a,0,0)};
Razor.SimpleNoise.prototype.buildSimpleNoise=function(){for(var a=4;a<=this.width;a*=2){var b=Math.floor(Math.random()*(this.width-a)),c=Math.floor(Math.random()*(this.height-a));this.contextSimple.globalAlpha=4/a;this.contextSimple.drawImage(this.whiteNoiseCanvas,b,c,a,a,0,0,this.width,this.height)}this.contextSimple.globalAlpha=this.A};Razor.SimpleNoise.prototype.getNoise=function(){return this.contextNoise.getImageData(0,0,this.width,this.height)};
Razor.SimpleNoise.prototype.getSimple=function(){return this.contextSimple.getImageData(0,0,this.width,this.height)};Razor.Debugger=function(a,b){Razor.FPS=a;Razor.logging=b;this.gui=new dat.GUI({autoPlace:!1});this.stats=new Stats;this.stats.setMode(0);this.init()};
Razor.Debugger.prototype.init=function(){var a=this,b=this.gui.addFolder("Razor");b.add(Razor,"FPS").onChange(function(b){a.stats.domElement.style.display=b?"block":"none"});b.add(Razor,"logging");b.open();this.gui.domElement.style.position="absolute";this.gui.domElement.style.right="0px";this.gui.domElement.style.top="40px";document.body.appendChild(this.gui.domElement);this.stats.domElement.style.position="absolute";this.stats.domElement.style.left="0px";this.stats.domElement.style.top="40px";document.body.appendChild(this.stats.domElement);
this.stats.domElement.style.display=!0==Razor.FPS?"block":"none"};Razor.Debugger.prototype.begin=function(){this.stats.begin()};Razor.Debugger.prototype.end=function(){this.stats.end()};Razor.log=function(a){this.logging&&console.log(a)};Razor.Math=function(){};Razor.Math.getAngleBetweenPointsRadiants=function(a,b,c,d){return Math.atan2(b-d,a-c)};Razor.Math.getAngleBetweenPointsDegrees=function(a,b,c,d){return 180*(Razor.Math.getAngleBetweenPointsRadiants(a,b,c,d)/Math.PI)};Razor.Math.getDistanceBetweenPoints=function(a,b,c,d){a-=c;b-=d;return Math.sqrt(a*a+b*b)};Razor.Math.getPointBetweenPointsBasedOnPercentage=function(a,b,c,d,e){var f=new Razor.Vector2;f.setX=a+e*(c-a);f.setY=b+e*(d-b);return f};
Razor.Math.getRandom=function(a,b,c){return!1==(void 0==c?!0:c)?Math.random()*(b-a)+a:Math.round(Math.random()*(b-a)+a)};Razor.Math.getValueBasedOnPercentage=function(a,b,c){return a*(c-b)/100+b};Razor.Math.map=function(a,b,c,d,e){return b==c?d:d+(e-d)*(a-b)/(c-b)};
